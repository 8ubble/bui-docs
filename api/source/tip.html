<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @fileOverview 简单易用的提示信息
 * @ignore
 */

define('bui/tooltip/tip',['bui/common','bui/overlay'],function (require) {
  var BUI = require('bui/common'),
    Overlay = require('bui/overlay'),
    CLS_ALIGN_PREFIX = 'x-align-',
    MAP_TYPES = {
      left : ['cl','cr'], //居左
      right : ['cr','cl'], //居右
      top : ['tc','bc'], //居上
      bottom : ['bc','tc'], //居下
      'top-left' : ['tl','bl'],
      'top-right' : ['tr','br'],
      'bottom-left' : ['bl','tl'],
      'bottom-right' : ['br','tr']
    };
  //获取距离
  function getOffset(type,offset){
    if(type === 'left'){
      return [-1 * offset,-4];
    }
    if(type === 'right'){
      return [offset,-4];
    }
    if(type.indexOf('top')){
      return [0,offset];
    }

    if(type.indexOf('bottom')){
      return [0,-1 * offset];
    }
  }

  var TipView = Overlay.OverlayView.extend({
    renderUI : function(){

    },
    //获取显示文本的容器
    _getTitleContainer : function(){
      return  this.get('el');
    },
    //设置文本
    _uiSetTitle : function(title){
      var _self = this,
        titleTpl = _self.get('titleTpl'),
        container = _self._getTitleContainer(),
        titleEl = _self.get('titleEl'),
        tem;
      if(titleEl){
        titleEl.remove();
      }
      title = title || '';
      if(BUI.isString(title)){
        title = {title : title};
      }
      tem = BUI.substitute(titleTpl,title);
      titleEl = $(tem).appendTo(container);
      _self.set('titleEl',titleEl);
    },
    //设置对齐样式
    _uiSetAlignType : function(type,ev){
      var _self = this;
      if(ev &amp;&amp; ev.prevVal){
        _self.get('el').removeClass(CLS_ALIGN_PREFIX + ev.prevVal);
      }
      if(type){
        _self.get('el').addClass(CLS_ALIGN_PREFIX + type);
      }
    }
  },{
    ATTRS : {
      title : {},
      titleEl : {},
      alignType : {}
    }
  },{
    xclass : 'tooltip-view'
  });
  
<span id='BUI-Tooltip-Tip'>  /**
</span>   * @class BUI.Tooltip.Tip
   * @extends BUI.Overlay.Overlay
   * 简易的提示信息
   */
  var Tip = Overlay.Overlay.extend({
    //设置对齐方式
    _uiSetAlignType : function(type){
      var _self = this,
        offset = _self.get('offset'),
        align = _self.get('align') || {},
        points = MAP_TYPES[type];
      if(points){
        align.points = points;
        if(offset){
          align.offset = getOffset(type,offset);
        }
        _self.set('align',align);
      }
    }
  },{
    ATTRS : {
      //使用委托的方式显示提示信息
      delegateTigger : {
        value : true
      },
<span id='BUI-Tooltip-Tip-property-alignType'>      /**
</span>       * 对齐类型，包括： top,left,right,bottom四种常用方式，其他对齐方式，可以使用@see{BUI.Tooltip.Tip-property-align}属性
       * @type {String}
       */
      alignType : {
        view : true
      },
<span id='BUI-Tooltip-Tip-property-title'>      /**
</span>       * 显示的内容，文本或者键值对
       *      new Tip({
       *        title : {a : 'text a',b:'text b'}, //属性是对象
       *        titleTpl : '&lt;p&gt;this is {a},because {b}&lt;/p&gt;' // &lt;p&gt;this is text a,because text b&lt;/p&gt;
       *      });
       * @type {String|Object}
       */
      title : {
        view : true
      },
<span id='BUI-Tooltip-Tip-property-showArrow'>      /**
</span>       * 显示对齐箭头
       * @override
       * @default true
       * @type {Boolean}
       */
      showArrow : {
        value : true
      },
<span id='BUI-Tooltip-Tip-property-arrowContainer'>      /**
</span>       * 箭头放置在的位置，是一个选择器，例如 .arrow-wraper
       *     new Tip({ //可以设置整个控件的模板
       *       arrowContainer : '.arrow-wraper',
       *       tpl : '&lt;div class=&quot;arrow-wraper&quot;&gt;&lt;/div&gt;'
       *     });
       *     
       *     new Tip({ //也可以设置title的模板
       *       arrowContainer : '.arrow-wraper',
       *       titleTpl : '&lt;div class=&quot;arrow-wraper&quot;&gt;{title}&lt;/div&gt;'
       *     });
       *     
       * @type {String}
       */
      arrowContainer : {
        view : true
      },
      //自动显示
      autoHide : {
        value : true
      },
      //覆盖自动隐藏类型
      autoHideType : {
        value : 'leave'
      },
<span id='BUI-Tooltip-Tip-property-offset'>      /**
</span>      * 显示的tip 距离触发器Dom的距离
      * @type {Number}
      */
      offset : {
        value : 0
      },
<span id='BUI-Tooltip-Tip-property-triggerEvent'>      /**
</span>       * 触发显示tip的事件名称，默认为mouseover
       * @type {String}
       */
      triggerEvent : {
        value : 'mouseover'
      },
<span id='BUI-Tooltip-Tip-property-titleTpl'>      /**
</span>       * 显示文本的模板
       * @type {String}
       */
      titleTpl : {
        view : true,
        value : '&lt;span&gt;{title}&lt;/span&gt;'
      },
      xview : {
        value : TipView
      }
    }
  },{
    xclass : 'tooltip'
  });

  Tip.View = TipView;

  return Tip;
});</pre>
</body>
</html>
